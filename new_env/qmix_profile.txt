Step 10: loss:  31.1073 - Average length:  6.20 - win ratio: 0.200 - 
Step 15: loss:  25.4420 - Average length: 14.80 - win ratio: 0.600 - 
Step 20: loss:  23.3012 - Average length: 14.40 - win ratio: 0.600 - 
Step 25: loss:  16.8201 - Average length: 13.60 - win ratio: 0.200 - 
Step 30: loss:  23.5284 - Average length: 15.40 - win ratio: 0.400 - 
Step 35: loss:  29.3212 - Average length: 19.00 - win ratio: 0.400 - 
Step 40: loss:  22.8864 - Average length: 11.80 - win ratio: 0.600 - 
Step 45: loss:  30.4853 - Average length: 37.60 - win ratio: 0.400 - 
Step 50: loss:  18.9571 - Average length: 14.40 - win ratio: 0.600 - 
Step 55: loss:  29.3574 - Average length: 18.20 - win ratio: 0.800 - 
Step 60: loss:  32.0176 - Average length: 12.80 - win ratio: 0.600 - 
Step 65: loss:  25.7458 - Average length: 12.00 - win ratio: 0.400 - 
Step 70: loss:  27.6441 - Average length: 17.00 - win ratio: 0.600 - 
Step 75: loss:  30.6297 - Average length: 26.40 - win ratio: 0.400 - 
Step 80: loss:  36.6323 - Average length: 16.00 - win ratio: 0.600 - 
Step 85: loss:  33.9644 - Average length: 13.20 - win ratio: 0.400 - 
Step 90: loss:  30.7144 - Average length: 23.40 - win ratio: 0.600 - 
Step 95: loss:  31.2849 - Average length:  9.60 - win ratio: 0.200 - 
Step 100: loss:  39.8291 - Average length: 13.00 - win ratio: 0.400 - 
Step 105: loss:  25.6335 - Average length: 23.00 - win ratio: 0.800 - 
Step 110: loss:  44.8274 - Average length: 26.40 - win ratio: 0.400 - 
Step 115: loss:  45.1304 - Average length: 34.60 - win ratio: 0.400 - 
Step 120: loss:  30.7058 - Average length: 21.00 - win ratio: 0.800 - 
Step 125: loss:  21.7126 - Average length: 25.00 - win ratio: 0.600 - 
Step 130: loss:  24.4548 - Average length:  7.00 - win ratio: 0.200 - 
Step 135: loss:  34.6236 - Average length: 11.00 - win ratio: 0.600 - 
Step 140: loss:  37.4114 - Average length: 15.20 - win ratio: 0.600 - 
Step 145: loss:  47.5870 - Average length: 18.80 - win ratio: 0.800 - 
Step 150: loss:  48.3402 - Average length: 14.80 - win ratio: 0.400 - 
Step 155: loss:  59.7261 - Average length: 15.80 - win ratio: 0.600 - 
Step 160: loss:  55.4434 - Average length: 10.80 - win ratio: 1.000 - 
Step 165: loss:  37.6338 - Average length: 12.00 - win ratio: 0.200 - 
Step 170: loss:  51.5602 - Average length: 16.40 - win ratio: 0.400 - 
Step 175: loss:  34.5445 - Average length: 17.20 - win ratio: 0.600 - 
Step 180: loss:  34.7879 - Average length: 14.20 - win ratio: 0.600 - 
Step 185: loss:  59.6970 - Average length: 24.00 - win ratio: 0.600 - 
Step 190: loss:  21.3745 - Average length: 28.40 - win ratio: 0.600 - 
Step 195: loss:  33.0352 - Average length: 12.20 - win ratio: 0.400 - 
Step 200: loss:  49.1655 - Average length: 13.60 - win ratio: 0.400 - 
Step 205: loss:  51.5238 - Average length: 13.80 - win ratio: 0.200 - 
Step 210: loss:  50.1552 - Average length: 17.20 - win ratio: 1.000 - 
Step 215: loss:  62.9197 - Average length: 23.80 - win ratio: 0.400 - 
Step 220: loss:  43.3207 - Average length: 18.60 - win ratio: 0.600 - 
Step 225: loss:  56.4783 - Average length: 15.20 - win ratio: 0.600 - 
Step 230: loss:  44.0748 - Average length: 10.00 - win ratio: 0.600 - 
Step 235: loss:  74.0146 - Average length: 14.40 - win ratio: 0.800 - 
Step 240: loss:  84.6229 - Average length: 16.20 - win ratio: 0.400 - 
Step 245: loss:  45.8990 - Average length: 19.00 - win ratio: 0.800 - 
Step 250: loss:  48.5305 - Average length: 17.20 - win ratio: 0.400 - 
Step 255: loss:  76.2902 - Average length: 15.20 - win ratio: 0.600 - 
Step 260: loss: 106.7968 - Average length: 32.60 - win ratio: 0.200 - 
Step 265: loss:  67.5574 - Average length: 16.80 - win ratio: 0.000 - 
Step 270: loss:  91.5896 - Average length: 25.40 - win ratio: 0.600 - 
Step 275: loss:  59.0147 - Average length: 15.00 - win ratio: 0.600 - 
Step 280: loss:  88.1831 - Average length: 28.20 - win ratio: 0.000 - 
Step 285: loss:  57.6126 - Average length: 11.80 - win ratio: 0.600 - 
Step 290: loss:  63.7059 - Average length: 21.80 - win ratio: 0.400 - 
Step 295: loss:  76.6707 - Average length: 15.40 - win ratio: 0.600 - 
Step 300: loss:  83.8027 - Average length: 13.40 - win ratio: 0.400 - 
Step 305: loss:  56.3272 - Average length: 18.00 - win ratio: 1.000 - 
Step 310: loss:  54.3614 - Average length: 13.80 - win ratio: 0.800 - 
Step 315: loss:  65.7851 - Average length: 24.20 - win ratio: 0.600 - 
Step 320: loss:  73.3172 - Average length: 21.40 - win ratio: 0.200 - 
Step 325: loss:  73.8592 - Average length: 13.20 - win ratio: 0.400 - 
Step 330: loss:  96.6309 - Average length:  8.00 - win ratio: 0.600 - 
Step 335: loss:  54.6159 - Average length: 19.00 - win ratio: 0.200 - 
Step 340: loss:  65.9279 - Average length: 17.20 - win ratio: 0.000 - 
Step 345: loss:  53.3903 - Average length: 15.40 - win ratio: 0.200 - 
Step 350: loss:  74.5760 - Average length: 25.60 - win ratio: 0.600 - 
Step 355: loss:  50.0805 - Average length: 20.20 - win ratio: 0.200 - 
Step 360: loss:  62.6165 - Average length: 15.20 - win ratio: 0.200 - 
Step 365: loss:  31.0258 - Average length: 23.00 - win ratio: 0.600 - 
Step 370: loss:  70.2516 - Average length: 17.80 - win ratio: 0.000 - 
Step 375: loss:  69.2999 - Average length:  6.80 - win ratio: 0.400 - 
Step 380: loss:  49.5696 - Average length: 11.80 - win ratio: 0.600 - 
Step 385: loss:  38.8321 - Average length: 15.60 - win ratio: 0.400 - 
Step 390: loss:  37.5889 - Average length: 17.80 - win ratio: 0.400 - 
Step 395: loss:  37.4756 - Average length: 23.40 - win ratio: 0.600 - 
Step 400: loss:  60.2781 - Average length: 14.40 - win ratio: 0.600 - 
Step 405: loss:  47.2422 - Average length: 18.20 - win ratio: 0.800 - 
Step 410: loss:  48.5448 - Average length:  9.60 - win ratio: 0.200 - 
Step 415: loss:  50.2396 - Average length: 17.80 - win ratio: 0.600 - 
Step 420: loss:  51.4948 - Average length: 12.40 - win ratio: 0.400 - 
Step 425: loss:  66.9043 - Average length: 17.20 - win ratio: 0.200 - 
Step 430: loss:  56.4062 - Average length: 19.20 - win ratio: 0.200 - 
Step 435: loss:  54.3475 - Average length: 18.20 - win ratio: 0.800 - 
Step 440: loss:  89.0590 - Average length: 12.20 - win ratio: 0.600 - 
Step 445: loss:  92.6429 - Average length: 19.60 - win ratio: 0.000 - 
Step 450: loss:  72.5289 - Average length: 19.40 - win ratio: 0.200 - 
Step 455: loss:  38.3444 - Average length: 11.80 - win ratio: 0.800 - 
Step 460: loss:  45.7401 - Average length: 17.80 - win ratio: 0.200 - 
Step 465: loss:  74.8944 - Average length: 16.00 - win ratio: 0.200 - 
Step 470: loss:  60.0337 - Average length: 19.00 - win ratio: 0.400 - 
Step 475: loss:  43.7599 - Average length: 28.80 - win ratio: 0.800 - 
Step 480: loss:  89.6827 - Average length: 21.20 - win ratio: 0.400 - 
Step 485: loss:  72.9637 - Average length: 21.60 - win ratio: 0.400 - 
Step 490: loss:  57.6737 - Average length: 24.80 - win ratio: 0.200 - 
Step 495: loss:  54.2661 - Average length: 21.80 - win ratio: 0.800 - 
Step 500: loss:  28.1872 - Average length: 19.60 - win ratio: 0.400 - 
Step 505: loss:  47.5975 - Average length:  7.80 - win ratio: 0.200 - 
Step 510: loss:  54.0670 - Average length: 11.60 - win ratio: 0.600 - 
Step 515: loss:  98.7051 - Average length: 10.60 - win ratio: 0.200 - 
Step 520: loss: 108.3692 - Average length: 14.40 - win ratio: 0.600 - 
Step 525: loss:  84.1367 - Average length:  8.80 - win ratio: 0.600 - 
Step 530: loss:  49.2100 - Average length: 20.60 - win ratio: 0.600 - 
Step 535: loss:  45.4430 - Average length: 14.60 - win ratio: 0.400 - 
Step 540: loss:  70.3086 - Average length: 15.00 - win ratio: 0.800 - 
Step 545: loss:  61.3002 - Average length: 13.60 - win ratio: 0.800 - 
Step 550: loss:  62.7163 - Average length: 16.60 - win ratio: 0.200 - 
Step 555: loss:  48.2690 - Average length: 17.20 - win ratio: 0.800 - 
Step 560: loss:  33.0581 - Average length: 16.60 - win ratio: 0.800 - 
Step 565: loss:  20.9195 - Average length: 14.40 - win ratio: 0.200 - 
Step 570: loss:  18.1067 - Average length: 19.60 - win ratio: 0.600 - 
Step 575: loss:  40.0346 - Average length: 18.80 - win ratio: 0.600 - 
Step 580: loss:  48.0081 - Average length: 15.80 - win ratio: 0.200 - 
Step 585: loss:  27.9536 - Average length:  9.40 - win ratio: 0.600 - 
Step 590: loss:  60.8176 - Average length: 14.40 - win ratio: 0.200 - 
Step 595: loss:  72.2593 - Average length:  8.40 - win ratio: 0.200 - 
Step 600: loss:  54.2463 - Average length: 22.60 - win ratio: 0.200 - 
Step 605: loss:  33.0696 - Average length: 14.00 - win ratio: 0.600 - 
Step 610: loss:  55.2041 - Average length: 19.40 - win ratio: 0.400 - 
Step 615: loss:  31.3044 - Average length: 12.20 - win ratio: 0.600 - 
Step 620: loss:  36.7645 - Average length: 31.00 - win ratio: 0.600 - 
Step 625: loss:  53.7205 - Average length: 16.60 - win ratio: 0.600 - 
Step 630: loss:  46.3919 - Average length: 18.60 - win ratio: 0.600 - 
Step 635: loss:  13.2124 - Average length: 26.20 - win ratio: 0.200 - 
Step 640: loss:  40.0969 - Average length: 17.40 - win ratio: 0.600 - 
Step 645: loss:  51.6604 - Average length: 12.60 - win ratio: 0.400 - 
Step 650: loss:  30.3069 - Average length: 21.60 - win ratio: 0.600 - 
Step 655: loss:  48.3064 - Average length: 20.20 - win ratio: 0.000 - 
Step 660: loss:  36.7846 - Average length: 14.80 - win ratio: 1.000 - 
Step 665: loss:  50.4910 - Average length: 17.00 - win ratio: 0.600 - 
Step 670: loss:  24.1453 - Average length: 22.20 - win ratio: 1.000 - 
Step 675: loss:  39.2856 - Average length: 13.20 - win ratio: 0.600 - 
Step 680: loss:  40.5473 - Average length: 16.20 - win ratio: 0.400 - 
Step 685: loss:  62.2990 - Average length: 18.80 - win ratio: 0.800 - 
Step 690: loss:  55.5958 - Average length: 13.80 - win ratio: 0.400 - 
Step 695: loss:  51.0971 - Average length: 18.20 - win ratio: 0.400 - 
Step 700: loss:  70.7326 - Average length: 21.80 - win ratio: 0.800 - 
Step 705: loss:  42.8198 - Average length: 27.60 - win ratio: 0.400 - 
Step 710: loss:  74.7848 - Average length: 15.00 - win ratio: 0.600 - 
Step 715: loss:  50.8264 - Average length: 17.20 - win ratio: 0.200 - 
Step 720: loss:  50.0440 - Average length: 23.60 - win ratio: 0.000 - 
Step 725: loss:  83.1027 - Average length: 31.60 - win ratio: 0.400 - 
Step 730: loss:  55.4844 - Average length: 10.80 - win ratio: 0.200 - 
Step 735: loss:  66.9779 - Average length: 24.60 - win ratio: 0.600 - 
Step 740: loss:  35.1025 - Average length: 27.80 - win ratio: 0.800 - 
Step 745: loss:  57.5932 - Average length: 13.40 - win ratio: 0.400 - 
Step 750: loss:  20.2088 - Average length: 27.00 - win ratio: 0.400 - 
Step 755: loss:  48.7136 - Average length: 19.20 - win ratio: 0.800 - 
Step 760: loss:  73.1379 - Average length: 20.20 - win ratio: 0.200 - 
Step 765: loss:  45.6910 - Average length: 29.60 - win ratio: 0.400 - 
Step 770: loss:  57.8570 - Average length: 26.40 - win ratio: 0.200 - 
Step 775: loss:  52.1388 - Average length: 11.80 - win ratio: 0.200 - 
Step 780: loss:  86.3561 - Average length: 18.00 - win ratio: 0.600 - 
Step 785: loss:  66.3689 - Average length: 22.80 - win ratio: 0.600 - 
Step 790: loss:  73.7744 - Average length: 29.40 - win ratio: 0.600 - 
Step 795: loss:  65.6435 - Average length: 16.00 - win ratio: 0.600 - 
Step 800: loss:  33.9394 - Average length: 24.20 - win ratio: 0.400 - 
Step 805: loss:  46.8841 - Average length: 23.80 - win ratio: 0.400 - 
Step 810: loss:  86.0147 - Average length: 18.80 - win ratio: 0.400 - 
Step 815: loss:  48.5873 - Average length: 17.40 - win ratio: 0.200 - 
Step 820: loss:  46.2640 - Average length: 24.40 - win ratio: 0.400 - 
Step 825: loss:  57.4935 - Average length: 20.20 - win ratio: 0.400 - 
Step 830: loss:  46.8146 - Average length: 11.40 - win ratio: 0.400 - 
Step 835: loss:  56.7095 - Average length: 18.80 - win ratio: 0.400 - 
Step 840: loss:  63.7507 - Average length: 12.40 - win ratio: 0.400 - 
Step 845: loss:  37.1393 - Average length: 29.40 - win ratio: 0.200 - 
Step 850: loss:  67.6818 - Average length: 14.40 - win ratio: 0.600 - 
Step 855: loss:  48.9999 - Average length: 15.60 - win ratio: 0.400 - 
Step 860: loss:  81.5651 - Average length: 25.60 - win ratio: 0.400 - 
Step 865: loss:  44.6116 - Average length: 22.40 - win ratio: 0.400 - 
Step 870: loss:  41.9833 - Average length: 31.60 - win ratio: 0.400 - 
Step 875: loss:  29.5201 - Average length: 21.00 - win ratio: 0.000 - 
Step 880: loss:  36.5711 - Average length: 14.20 - win ratio: 0.200 - 
Step 885: loss:  46.3999 - Average length: 15.80 - win ratio: 0.400 - 
Step 890: loss:  57.4843 - Average length: 13.00 - win ratio: 0.400 - 
Step 895: loss:  59.7058 - Average length: 14.00 - win ratio: 0.800 - 
Step 900: loss:  57.4104 - Average length: 20.60 - win ratio: 0.800 - 
Step 905: loss:  66.4276 - Average length: 41.60 - win ratio: 0.800 - 
Step 910: loss:  52.3645 - Average length: 18.20 - win ratio: 0.000 - 
Step 915: loss:  38.5790 - Average length: 16.20 - win ratio: 0.600 - 
Step 920: loss:  67.8408 - Average length: 28.00 - win ratio: 0.400 - 
Step 925: loss:  58.0733 - Average length: 20.80 - win ratio: 0.600 - 
Step 930: loss:  55.8423 - Average length: 17.40 - win ratio: 1.000 - 
Step 935: loss:  58.5341 - Average length: 11.20 - win ratio: 0.400 - 
Step 940: loss:  34.2710 - Average length: 18.40 - win ratio: 0.400 - 
Step 945: loss:  77.9093 - Average length: 28.20 - win ratio: 0.600 - 
Step 950: loss:  31.0593 - Average length: 20.00 - win ratio: 0.400 - 
Step 955: loss:  43.3197 - Average length: 34.20 - win ratio: 0.800 - 
Step 960: loss:  33.7597 - Average length: 16.00 - win ratio: 0.800 - 
Step 965: loss:  27.7442 - Average length: 32.60 - win ratio: 0.800 - 
Step 970: loss:  36.9048 - Average length: 26.20 - win ratio: 0.800 - 
Step 975: loss:  40.0852 - Average length: 19.00 - win ratio: 0.400 - 
Step 980: loss:  25.0190 - Average length: 31.00 - win ratio: 0.400 - 
Step 985: loss:  37.6151 - Average length: 18.40 - win ratio: 0.200 - 
Step 990: loss:  26.0356 - Average length: 14.60 - win ratio: 0.400 - 
Step 995: loss:  60.9976 - Average length: 29.80 - win ratio: 0.600 - 

*** PROFILER RESULTS ***
train (qmix.py:98)
function called 1 times

         119449064 function calls (104623487 primitive calls) in 392.219 seconds

   Ordered by: cumulative time, internal time, call count
   List reduced from 290 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    7.189    7.189  392.401  392.401 qmix.py:98(train)
1090822/274192    6.095    0.000  151.072    0.001 module.py:531(__call__)
      991   14.150    0.014  145.053    0.146 qmix.py:64(compute_q)
   272210    4.357    0.000  142.312    0.001 models.py:61(forward)
     1000    0.315    0.000  131.597    0.132 utilities.py:57(generate_episode)
    19514    0.443    0.000  109.533    0.006 env.py:53(copy)
11284578/19514   25.041    0.000  109.090    0.006 copy.py:132(deepcopy)
1853830/19514    8.930    0.000  108.688    0.006 copy.py:268(_reconstruct)
662291/19514    6.118    0.000  108.255    0.006 copy.py:236(_deepcopy_dict)
253680/19514    0.903    0.000  106.471    0.005 copy.py:210(_deepcopy_list)
      991    0.009    0.000   88.987    0.090 tensor.py:138(backward)
      991    0.011    0.000   88.978    0.090 __init__.py:44(backward)
      991   88.918    0.090   88.918    0.090 {method 'run_backward' of 'torch._C._EngineBase' objects}
   272210    2.547    0.000   70.644    0.000 rnn.py:1014(forward)
   272210   65.827    0.000   65.827    0.000 {built-in method gru_cell}
   272210   24.023    0.000   33.178    0.000 models.py:69(process)
   329369    4.890    0.000   21.708    0.000 tensor.py:23(__deepcopy__)
   312224    2.700    0.000   20.331    0.000 parameter.py:28(__deepcopy__)
   544420    1.811    0.000   19.725    0.000 linear.py:86(forward)
    18514    0.130    0.000   18.960    0.001 env.py:231(act)
    18514    1.347    0.000   17.833    0.001 qmix.py:40(act)
   544420    1.581    0.000   17.423    0.000 functional.py:1355(linear)
   312224   16.431    0.000   16.431    0.000 {method 'clone' of 'torch._C._TensorBase' objects}
   544420   11.475    0.000   11.475    0.000 {built-in method addmm}
   329369    0.837    0.000   10.974    0.000 storage.py:24(__deepcopy__)
   329369    3.403    0.000   10.023    0.000 storage.py:40(clone)
     1982    0.117    0.000    6.704    0.003 mixers.py:49(forward)
     1000    0.017    0.000    6.528    0.007 env.py:166(reset)
     1982    4.829    0.002    5.997    0.003 mixers.py:7(process_qs)
   329369    5.075    0.000    5.075    0.000 {method 'copy_' of 'torch._C.FloatStorageBase' objects}
   548384    4.906    0.000    4.906    0.000 {built-in method tensor}
  4621504    3.085    0.000    4.744    0.000 {built-in method builtins.getattr}
  3308566    4.136    0.000    4.460    0.000 module.py:571(__getattr__)
 23416285    4.458    0.000    4.458    0.000 {method 'get' of 'dict' objects}
  3411394    2.981    0.000    4.346    0.000 copy.py:252(_keep_alive)
      991    0.809    0.001    4.341    0.004 adam.py:49(step)
      991    0.084    0.000    4.172    0.004 clip_grad.py:6(clip_grad_norm_)
   276174    4.170    0.000    4.170    0.000 {built-in method zeros}
   272210    0.280    0.000    4.165    0.000 functional.py:904(relu)
   544420    4.159    0.000    4.159    0.000 {method 't' of 'torch._C._TensorBase' objects}


